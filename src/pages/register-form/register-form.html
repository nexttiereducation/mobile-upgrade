<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Create an account</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content class="bg-blue external-page">
  <ion-grid>
    <ion-row class="ion-align-items-center ion-justify-content-start">
      <ion-col class="ion-margin-bottom ion-padding-bottom ion-text-center">
        <img class="nte-logo"
             src="assets/image/logo/circle.svg">
        <div class="blue-divider"></div>
        <div class="text-white bold external-header">Last step!</div>
      </ion-col>
    </ion-row>
  </ion-grid>
  <form [formGroup]="registerForm"
        (ngSubmit)="register()">
    <ion-list no-lines>
      <div class="validation-error"
           [class.hidden]="!invalid['first']">Please enter a first name</div>
      <ion-item class="bg-white10 border-white50"
                [class.border-white-bold]="user.first_name?.length">
        <ion-label [class.bg-red]="invalid['first']"
                   [color]="user.first_name?.length ? 'white' : 'white50'">
          <ion-icon class="form-icon"
                    name="person"></ion-icon>
        </ion-label>
        <ion-input formControlName="first"
                   placeholder="First name*"
                   required
                   type="text"
                   (ionBlur)="validate('first')"
                   (ionChange)="checkValidate('first')"
                   (ionFocus)="setIsInitialEntry('first')"
                   [(ngModel)]="user.first_name"></ion-input>
      </ion-item>
      <div class="validation-error"
           [class.hidden]="!invalid['last']">Please enter a last name</div>
      <ion-item class="bg-white10 border-white50"
                [class.border-white-bold]="user.last_name?.length">
        <ion-label [class.bg-red]="invalid['last']"
                   [color]="user.last_name?.length ? 'white' : 'white50'">
          <ion-icon class="form-icon"
                    name="person"></ion-icon>
        </ion-label>
        <ion-input formControlName="last"
                   placeholder="Last name*"
                   required
                   type="text"
                   (ionBlur)="validate('last')"
                   (ionChange)="checkValidate('last')"
                   (ionFocus)="setIsInitialEntry('last')"
                   [(ngModel)]="user.last_name"></ion-input>
      </ion-item>
      <div class="validation-error"
           [class.hidden]="!invalid['email']">Please enter a valid email address</div>
      <ion-item class="bg-white10 border-white50"
                [class.border-white-bold]="user.email?.length">
        <ion-label [class.bg-red]="invalid['email']"
                   [color]="user.email?.length ? 'white' : 'white50'">
          <ion-icon class="form-icon"
                    name="mail"></ion-icon>
        </ion-label>
        <ion-input formControlName="email"
                   placeholder="Email*"
                   required
                   type="email"
                   (ionBlur)="validate('email')"
                   (ionChange)="checkValidate('email')"
                   (ionFocus)="setIsInitialEntry('email')"
                   [(ngModel)]="user.email"></ion-input>
      </ion-item>
      <div class="validation-error"
           [class.hidden]="!invalid['confirm']">Email addresses do not match</div>
      <ion-item class="bg-white10 border-white50"
                [class.border-white-bold]="user.confirmEmail?.length">
        <ion-label [class.bg-red]="invalid['confirm']"
                   [color]="user.confirmEmail?.length ? 'white' : 'white50'">
          <ion-icon class="form-icon"
                    name="mail"></ion-icon>
        </ion-label>
        <ion-input formControlName="confirm"
                   placeholder="Confirm email*"
                   required
                   type="email"
                   (ionBlur)="validate('confirm')"
                   (ionChange)="checkValidate('confirm')"
                   (ionFocus)="setIsInitialEntry('confirm')"
                   [pattern]="checkConfirmEmail()"
                   [(ngModel)]="user.confirmEmail"></ion-input>
      </ion-item>
      <div class="validation-error"
           [class.hidden]="!invalid['password']">Password must be at least 8 characters</div>
      <ion-item class="bg-white10 border-white50"
                [class.border-white-bold]="user.password?.length">
        <ion-label [class.bg-red]="invalid['password']"
                   [color]="user.password?.length ? 'white' : 'white50'">
          <ion-icon class="form-icon"
                    name="lock"></ion-icon>
        </ion-label>
        <ion-input formControlName="password"
                   placeholder="Password*"
                   required
                   type="password"
                   (ionBlur)="validate('password')"
                   (ionChange)="checkValidate('password')"
                   (ionFocus)="setIsInitialEntry('password')"
                   [(ngModel)]="user.password"></ion-input>
      </ion-item>
    </ion-list>
    <ion-button class="no-caps"
                color="white"
                expand="block"
                size="large"
                type="submit"
                [disabled]="registerForm.invalid">
      <span class="text-blue bold">{{ loggingIn ? "Logging in..." : "Let's go!" }}</span>
    </ion-button>
  </form>
</ion-content>
