"use strict";var __decorate=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,c=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(c=(r<3?n(c):3<r?n(t,o,c):n(t,o))||c);return 3<r&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),core_2=require("@capacitor/core"),rxjs_1=require("rxjs"),PushNotifications=core_2.Plugins.PushNotifications,PushNotificationService=function(){function e(e){this.api=e,this._fcmToken=new rxjs_1.BehaviorSubject(null)}return Object.defineProperty(e.prototype,"fcmToken",{get:function(){return this._fcmToken.getValue()},set:function(e){this.fcmToken&&e===this.fcmToken||(this._fcmToken.next(e),this.setToken())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fcmToken$",{get:function(){return this._fcmToken.asObservable()},enumerable:!0,configurable:!0}),e.prototype.init=function(){PushNotifications.register(),PushNotifications.addListener("registration",function(e){console.log("Push registration success, token: "+e.value)}),PushNotifications.addListener("registrationError",function(e){console.log("Error on registration: "+JSON.stringify(e))}),PushNotifications.addListener("pushNotificationReceived",function(e){console.log("Push received: "+JSON.stringify(e))}),PushNotifications.addListener("pushNotificationActionPerformed",function(e){console.log("Push action performed: "+JSON.stringify(e))})},e.prototype.setToken=function(){var e=this;this.fcmToken&&this.fcmToken.length&&this.api.post("/notification/",{token:this.fcmToken}).subscribe(function(){console.log("FCM token posted to NextTier API: "+e.fcmToken)})},e=__decorate([core_1.Injectable({providedIn:"root"})],e)}();exports.PushNotificationService=PushNotificationService;